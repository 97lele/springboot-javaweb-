<!DOCTYPE HTML>
<html>
<head>
<title>购物车</title>
<link href="../assets/css/bootstrap.css" rel='stylesheet' type='text/css' />
<!-- jQuery (necessary JavaScript plugins) -->
<script type='text/javascript' src="../assets/js/jquery-1.10.2.js"></script>
<!-- Custom Theme files -->
<link href="../assets/css/style.css" rel='stylesheet' type='text/css' />
<!-- Custom Theme files -->
<meta name="viewport" content="width=device-width, initial-scale=1" charset="utf-8">
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<!-- start menu -->
<link href="../assets/css/megamenu.css" rel="stylesheet" type="text/css" media="all" />
<script type="text/javascript" src="../assets/js/megamenu.js"></script>
<script>$(document).ready(function(){$(".megamenu").megamenu();});</script>
<script src="../assets/js/menu_jquery.js"></script>
<script type="text/javascript" src="../assets/js/vue.js"></script>
<script type="text/javascript" src="../assets/js/vue-resource.min.js"></script>
<link rel="stylesheet" href="../assets/css/etalage.css">
<script src="../assets/js/jquery.etalage.min.js"></script>
<script>
		
		</script>
<!-- the jScrollPane script -->
<script type="text/javascript" src="../assets/js/jquery.jscrollpane.min.js"></script>
		<script type="text/javascript" id="sourcecode">
			$(function()
			{
				$('.scroll-pane').jScrollPane();
			});
		</script> 
</head>
<body>
<!-- header_top -->
<div class="top_bg">
<div class="container">
<div class="header_top">
	<div class="top_left">
		<h2><a href="#">通知</a> 尊敬的用户您好，请尽快完善信息！  </h2>
	</div>
	<div class="top_right">
		<ul>
			<li><a href="history.html">近期浏览历史</a></li>
		<li class="login" >
						<div  id="loginContainer">|<a href="#" id="loginButton"><span>登陆</span></a>
						    <div id="loginBox">                
						        <form id="loginForm">
						                <fieldset id="body">
						                	<fieldset>
						                          <label for="account">用户名</label>
						                          <input type="text" name="account" id="account">
						                    </fieldset>
						                    <fieldset>
						                            <label for="password">密码</label>
						                            <input type="password" name="password" id="password">
						                     </fieldset>
						                     <script>
						                     function func(){
						                    	 return false;
						                     }
						                     </script>
						                    <input type="submit" id="login" value="登陆" onclick="return func()">
						            	</fieldset>
							 </form>
				        </div>
			      </div>
			      							<div  id="logout" >|<a href="http://localhost:8080/user/logout" id="loginButton"><span>&nbsp;&nbsp;注销</span></a></div>
			      			      
			</li>
		</ul>
	</div>
	<div class="clearfix"></div>
</div>
</div>
</div>
<!-- header -->
<div class="header_bg">
<div class="container">
	<div class="header">
		<div class="logo">
			<a href="index.html"><img src="../assets/img/logo.png" alt="" style="height:50px;width="50px"/><span style="color:blue">&nbsp;&nbsp;( ¯(∞)¯ )の店&nbsp;&nbsp;</span><img src="../assets/img/logo2.png" alt="" style="height:50px;width="50px"/> </a>
		</div>
		
		<!-- start header_right -->
		<div class="header_right" id="sign">
	
	
	
		
	
		<div class="clearfix"></div>
		</div>
		<!-- start header menu -->
		<ul class="megamenu skyblue">
				<li><a class="color1" href="product.html">主页</a></li>
			
						
			
				<li><a class="color3" href="buy.html">购物车</a></li>
								<li><a class="color5" href="order.html">订单中心</a></li>
								<li><a class="color2 " href="user.html">用户中心</a></li>
						
			
		</ul>
	</div>
</div>
</div>
<!-- content -->
<div id="content">
<div class="container">
<div class="main">
<div class="registration">
		<div class="registration_left" id="sign"  v-if="account==''">
		<h2>注册账号 </span></h2>
		<!-- [if IE] 
		    < link rel='stylesheet' type='text/css' href='ie.css'/>  
		 [endif] -->  
		  
		<!-- [if lt IE 7]>  
		    < link rel='stylesheet' type='text/css' href='ie6.css'/>  
		<! [endif] -->  
	
		 <div class="registration_form">
		 <!-- Form -->
				<div >
					<label>
						<input  placeholder="账号:" type="text" tabindex="1" v-model="saccount" >
					</label>
				</div>
				<div>
					<label>
						<input placeholder="密码:" type="text" tabindex="2" v-model="spassword" >
					</label>
				</div>
				
				<div>
				
					<input type="submit" value="注册" onclick="return func()" id="register-submit" @click="sign">
				</div>
				
			<!-- /Form -->
		</div>
	</div>
	<div class="registration_left" v-if="account!=''">
		<h2>完善信息</h2>
		 <div class="registration_form">
		 <!-- Form -->
			<form id="registration_form" >
				<div>
					<label>
						<input v-model="email" placeholder="邮箱:" type="email"  >
					</label>
				</div>
			
				<div>
					<label>
						<input v-model="mobile" placeholder="手机号" type="text" >
					</label>
				</div>						
				<div>
					<label>
						<input v-model="address" placeholder="收货地址" type="text"  >
					</label>
				</div>	
				<div>
					<label>
						<input v-model="password" placeholder="密码" type="text" tabindex="5" >
					</label>
				</div>			
				<div>
					<input type="submit" value="更新/完善信息" onclick="return func()" id="register-submit" @click="update">
				</div>
			
			</form>
			<!-- /Form -->
			</div>
	</div>
		<div class="registration_left" v-if="account!=''">
	
		 <div class="registration_form">
		 <!-- Form -->
			<form id="registration_form" action="contact.php" method="post">
				<div>
					<label>
						用户名：{{account}}
					</label>
				</div>
				
				<div>
					<label>
						邮箱：{{email}}
					</label>
				</div>
				<div>
					<label>
						手机号：{{mobile}}
					</label>
				</div>
				<div>
					<label>
						密码：{{password}}
					</label>
				</div><div>
					<label>
					收货地址：<span >{{address}}</span>
					</label>
				</div>
				<div>
					<label>
						当前状态：<span v-if="status==0" style="color:red">冻结</span><span v-else>正常</span>
					</label>
				</div>
				
			</form>
			<!-- /Form -->
		</div>
		</div>
	<div class="clearfix"></div>
	</div>
	

</div>
</div>
</div>

</body>
<script>




$(function() {
	//先访问后台看是否有此用户记录，有就直接跳转到index.html
 	$.ajax({
		url: "http://localhost:8080/user/whetherLogin",
		type: "GET",
		success: function(data) {
		if(data.success){
			var d=data.msg.split('-');
			$('#loginContainer').hide();
			$('#sign').hide();
			$('#weclome').text('欢迎您,'+d[0])
			$('#logout').show();
		}else{
           $('#logout').hide();
		}
		}
	})
	

})

	 $('#login').on('click', function() {
			$.ajax({
				type: "POST",
				url: "http://localhost:8080/user/login",
				data: {
					account: $('#account').val(),
					password: $('#password').val(),
					role:0,
				},
				success: function(data) {
if(data.success){
	window.location.href="./product.html"
}else{
	alert(data.msg)
}
				}
			})
		})</script>
<script>

new Vue({
	el : '#content',
	data : {
		saccount:"",
		spassword:"",
		account:"",
		password:"",
		address:"",
		email:"",
		mobile:"",
		head : "http://localhost:8080/user",
		status:"",
		userId:"",
		
	},
	mounted : function() {
		this.getSelf();
		
	},
	methods : {
		
	
		
		
	

		sign:function(){
			this.$http.post(this.head+"/sign", {

				account:this.saccount,
				password:this.spassword,

			}, {
				emulateJSON : true
			}).then(function(res) {
				if (res.body.success) {
					alert("用户创建成功");
					window.location.href="user.html"
				}

			}, function(res) {
				console.log(res.status);
			});
		},

	
		update : function() {
			
			this.$http.post(this.head+"/update", {

				account:this.account,
				password:this.password,
				address:this.address,
				mobile:this.mobile,
				email:this.email,
				userId:this.userId,

			}, {
				emulateJSON : true
			}).then(function(res) {
				if (res.body.success) {
					alert("更新成功");
					this.getSelf()
				}

			}, function(res) {
				console.log(res.status);
			});
		},
	
		
	

		getSelf : function() {
			this.$http.get(this.head+"/getSelf").then(function(res) {

				if(res.body.success){
					console.log(res.body.data.user)
this.account=res.body.data.user.account;
					this.password=res.body.data.user.password
					this.address=res.body.data.user.address
					this.email=res.body.data.user.email
					this.mobile=res.body.data.user.mobile
					this.status=res.body.data.user.status
					this.userId=res.body.data.user.userId
				}
			

			})
		},
	
	
	}
})
</script>


</html>